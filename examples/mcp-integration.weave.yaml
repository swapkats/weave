version: "1.0"

# Example: Using MCP (Model Context Protocol) tools
# This demonstrates integrating external MCP servers for extended functionality
#
# All MCP servers are configured directly in this file - no separate config needed!
# Set required environment variables (e.g., GITHUB_TOKEN) before running.

# MCP Server Configuration
# Configure external tool providers that agents can use
mcp_servers:
  # Filesystem server for file operations
  filesystem:
    command: "npx"
    args:
      - "-y"
      - "@modelcontextprotocol/server-filesystem"
    description: "File system operations (read, write, list)"
    enabled: true

  # Web server for fetching and scraping
  web:
    command: "npx"
    args:
      - "-y"
      - "@modelcontextprotocol/server-fetch"
    description: "Web fetching and scraping"
    enabled: true

  # GitHub server for repository operations
  # Note: Disabled by default - requires GITHUB_TOKEN environment variable
  # To enable: set enabled: true and export GITHUB_TOKEN=your_token
  github:
    command: "npx"
    args:
      - "-y"
      - "@modelcontextprotocol/server-github"
    description: "GitHub API integration (requires GITHUB_TOKEN)"
    enabled: false

  # Database server for SQL operations
  database:
    command: "npx"
    args:
      - "-y"
      - "@modelcontextprotocol/server-sqlite"
    description: "SQLite database operations"
    enabled: true

# Agent definitions
agents:
  # File analyzer - uses filesystem MCP server
  file_analyzer:
    model: "gpt-4"
    tools:
      - read_file        # From filesystem MCP server
      - list_files       # From filesystem MCP server
      - text_length      # Built-in tool
    outputs: "file_analysis"

  # Web researcher - uses web MCP server
  web_researcher:
    model: "claude-3-opus"
    inputs: "file_analyzer"
    tools:
      - fetch_url        # From web MCP server
      - extract_links    # From web MCP server
      - json_validator   # Built-in tool
    outputs: "research_data"

  # Code reviewer - uses GitHub MCP server
  code_reviewer:
    model: "gpt-4"
    inputs: "web_researcher"
    tools:
      - get_repository   # From GitHub MCP server
      - list_issues      # From GitHub MCP server
      - search_code      # From GitHub MCP server
      - string_formatter # Built-in tool
    outputs: "code_review"

  # Data analyst - uses database MCP server
  data_analyst:
    model: "claude-3-opus"
    inputs: "code_reviewer"
    tools:
      - query_database   # From database MCP server
      - list_tables      # From database MCP server
      - calculator       # Built-in tool
      - list_operations  # Built-in tool
    outputs: "analysis_results"

  # Report writer - standalone for flexibility
  report_writer:
    model: "gpt-4"
    tools:
      - write_file       # From filesystem MCP server
      - string_formatter # Built-in tool
    outputs: "final_report"

weaves:
  mcp_workflow:
    description: "Complex workflow using multiple MCP servers"
    agents:
      - file_analyzer
      - web_researcher
      - code_reviewer
      - data_analyst
      - report_writer

  # Alternative: File and web workflow
  file_and_web:
    description: "File analysis and web research"
    agents:
      - file_analyzer
      - web_researcher
      - report_writer

  # Alternative: Complete analysis workflow
  full_analysis:
    description: "Full analysis including GitHub and database"
    agents:
      - file_analyzer
      - web_researcher
      - code_reviewer
      - data_analyst
      - report_writer
